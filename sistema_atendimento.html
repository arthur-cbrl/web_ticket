<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <title>Sistema de Atendimento - Painel Central</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #e6e6e6;
      margin: 0;
      padding: 0;
    }

    h1 {
      text-align: center;
      margin: 40px 0 30px 0;
      color: #1a237e;
      text-transform: uppercase;
      letter-spacing: 2px;
      font-size: 32px;
      font-weight: bold;
    }

    .painel-centro {
      width: 95%;
      max-width: 1270px;
      margin: auto;
      background: white;
      padding: 35px;
      border-radius: 14px;
      box-shadow: 0px 5px 16px rgba(0, 0, 0, 0.25);
      text-align: center;
      margin-bottom: 40px;
    }

    .painel-centro h2 {
      font-size: 28px;
      color: #1a237e;
      margin-bottom: 20px;
    }

    .ultima-senha {
      font-size: 26px;
      font-weight: bold;
      margin-bottom: 20px;
      color: #333;
    }

    .lista-senhas {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 18px;
      margin-top: 20px;
    }

    .painel-item {
      background: #f7f7f7;
      border-radius: 10px;
      padding: 18px;
      font-size: 20px;
      border: 1px solid #ccc;
      font-weight: bold;
    }

    .painel-item strong {
      color: #1a237e;
      font-size: 22px;
    }

    .container {
      display: flex;
      justify-content: center;
      gap: 20px;
      flex-wrap: wrap;
      padding-bottom: 40px;
    }

    .box {
      background: rgb(255, 255, 255);
      padding: 25px;
      width: 380px;
      border-radius: 20px;
      box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.15);
      text-align: center;
      transition: 0.2s;
    }

    .box:hover {
      transform: scale(1.01);
    }

    h2 {
      color: #1a237e;
      margin-bottom: 15px;
      font-size: 22px;
    }

    button {
      width: 100%;
      padding: 12px;
      margin-top: 12px;
      border: none;
      color: white;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      transition: 0.2s;
    }

    .sp {
      background: #c62828;
    }

    .sp:hover {
      background: #8e0000;
    }

    .sg {
      background: #1565c0;
    }

    .sg:hover {
      background: #0d47a1;
    }

    .se {
      background: #2e7d32;
    }

    .se:hover {
      background: #1b5e20;
    }

    .call {
      background: #ef6c00;
    }

    .call:hover {
      background: #e65100;
    }

    footer {
      padding: 20px;
      background: #1a237e;
      color: white;
      text-align: center;
      font-size: 14px;
      letter-spacing: 1px;
      margin-top: 40px;
    }
  </style>
</head>

<body>

  <h1>Sistema de Controle de Atendimento</h1>

  <div id="root"></div>
  <br><br><br>
  <footer>
    Sistema de Controle de Atendimento • Projeto Acadêmico • 2025
  </footer>

  
  <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>


  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  
  <script type="text/babel">

    const PADRAO = {
      contadores: { SP: 2026, SG: 5521, SE: 1189 },
      fila: { SP: [], SG: [], SE: [] },
      emitidas: 0,
      painelHistorico: [],
      guiches: {
        "01": { atendidas: 0, chamando: "Aguardando..." },
        "03": { atendidas: 0, chamando: "Aguardando..." }
      }
    };

    const loadState = () =>
      JSON.parse(localStorage.getItem("atendimentoState")) || PADRAO;

    const saveState = (state) =>
      localStorage.setItem("atendimentoState", JSON.stringify(state));

    function App() {
      const [state, setState] = React.useState(loadState());

      const atualizar = (novo) => {
        setState(novo);
        saveState(novo);
      };

      const emitirSenha = (tipo, guicheDefault) => {
        const novo = { ...state };

        novo.contadores[tipo]++;
        novo.emitidas++;

        const senha = `${tipo}-${novo.contadores[tipo]}`;
        novo.fila[tipo].push(senha);

        novo.ultimaSenha = `${senha} (Sugestão: ${guicheDefault})`;

        atualizar(novo);
      };

      const chamar = (id) => {
        const novo = { ...state };
        const g = novo.guiches[id];

        if (g.ocupado) return alert(`O Guichê ${id} está ocupado!`);

        let tipo = null;
        if (novo.fila.SP.length) tipo = "SP";
        else if (novo.fila.SG.length) tipo = "SG";
        else if (novo.fila.SE.length) tipo = "SE";

        if (!tipo) {
          g.chamando = "Aguardando...";
          atualizar(novo);
          return alert("Não há senhas!");
        }

        const senha = novo.fila[tipo].shift();

        g.atendidas++;
        g.chamando = `${senha} • Guichê ${id}`;
        g.ocupado = true;

        novo.ultimaChamada = g.chamando;

        novo.painelHistorico.unshift({ senha, guiche: id });
        if (novo.painelHistorico.length > 6) novo.painelHistorico.pop();

        atualizar(novo);

        setTimeout(() => {
          const finish = { ...novo };
          finish.guiches[id].ocupado = false;
          atualizar(finish);
        }, 3000);
      };

      return (
        <>
          <div className="container">

            {/* TOTEM */}
            <div className="box">
              <h2>Totem de Senhas</h2>

              <button className="sp" onClick={() => emitirSenha("SP", "03")}>Emitir Prioritária (SP)</button>
              <button className="sg" onClick={() => emitirSenha("SG", "02")}>Emitir Geral (SG)</button>
              <button className="se" onClick={() => emitirSenha("SE", "01")}>Emitir Exames (SE)</button>

              <p style={{ marginTop: 20, fontWeight: "bold", color: "#444" }}>
                Última senha:<br />
                <strong>{state.ultimaSenha || "Clique para emitir..."}</strong>
              </p>

              <p>Fila SP: <strong>{state.fila.SP.length}</strong></p>
              <p>Fila SG: <strong>{state.fila.SG.length}</strong></p>
              <p>Fila SE: <strong>{state.fila.SE.length}</strong></p>
              <p>Total Emitidas: <strong>{state.emitidas}</strong></p>
            </div>

            {/* GUICHÊ 01 */}
            <div className="box">
              <h2>Atendente (Guichê 01)</h2>
              <p>Guichê Atual: <strong>01</strong></p>

              <p>Status:
                <strong style={{ color: state.guiches["01"].ocupado ? "red" : "green" }}>
                  {state.guiches["01"].ocupado ? "Ocupado" : "Livre"}
                </strong>
              </p>

              <button className="call" onClick={() => chamar("01")}>Chamar Próximo</button>

              <p style={{ marginTop: 20, fontWeight: "bold", fontSize: 20 }}>
                Chamando agora:<br />
                <strong>{state.guiches["01"].chamando}</strong>
              </p>

              <p>Atendidas: <strong>{state.guiches["01"].atendidas}</strong></p>
            </div>

            {/* GUICHÊ 03 */}
            <div className="box">
              <h2>Atendente (Guichê 03)</h2>
              <p>Guichê Atual: <strong>03</strong></p>

              <p>Status:
                <strong style={{ color: state.guiches["03"].ocupado ? "red" : "green" }}>
                  {state.guiches["03"].ocupado ? "Ocupado" : "Livre"}
                </strong>
              </p>

              <button className="call" onClick={() => chamar("03")}>Chamar Próximo</button>

              <p style={{ marginTop: 20, fontWeight: "bold", fontSize: 20 }}>
                Chamando agora:<br />
                <strong>{state.guiches["03"].chamando}</strong>
              </p>

              <p>Atendidas: <strong>{state.guiches["03"].atendidas}</strong></p>
            </div>
          </div>

          {/* PAINEL */}
          <div className="painel-centro">
            <h2>Painel Principal</h2>

            <div className="ultima-senha">
              Última chamada:
              <span style={{ color: "#1a237e", marginLeft: 8 }}>
                {state.ultimaChamada || "Aguardando chamada..."}
              </span>
            </div>

            <h3 style={{ marginTop: 20, color: "#444", fontSize: 22 }}>Últimas 6 senhas</h3>

            <div className="lista-senhas">
              {state.painelHistorico.map((item, index) => (
                <div className="painel-item" key={index}>
                  {item.senha}<br />
                  Guichê <strong>{item.guiche}</strong>
                </div>
              ))}
            </div>
          </div>
        </>
      );
    }

    ReactDOM.render(<App />, document.getElementById("root"));
  </script>

</body>

</html>
